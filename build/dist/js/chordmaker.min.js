function ChordFactory(a){if(!(this instanceof ChordFactory))throw new TypeError("ChordFactory cannot be called as a function.");a||(a={}),this._init(a)}function ChordModel(a){if(!(this instanceof ChordModel))throw new TypeError("ChordModel cannot be called as a function.");a||(a={}),this._init(a)}function ChordParser(a){if(!(this instanceof ChordParser))throw new TypeError("ChordParser cannot be called as a function.");a||(a={}),this._init(a)}function ChordView(a,b,c){if(!(this instanceof ChordView))throw new TypeError("ChordView constructor cannot be called as a function.");b||(b={}),c||(c=new ChordModel),this._init(a,b,c)}function GuitarNote(a,b,c){if(!(this instanceof GuitarNote))throw new TypeError("GuitarNote constructor cannot be called as a function.");c||(c={}),this._init(a,b,c)}function GuitarNoteFactory(a){if(!(this instanceof GuitarNoteFactory))throw new TypeError("GuitarNoteFactory constructor cannot be called as a function.");a||(a={}),this._init(a)}function Tuning(a){if(!(this instanceof Tuning))throw new TypeError("tuningStr cannot be called as a function.");this._init(a)}function TuningFactory(){throw Error("Cannot instantiate TuningFactory.")}function Voicings(){throw new Error("Voicings is a singleton. Do not call the constructor")}function Aex(){}ChordFactory.DEFAULT_OPTIONS={version:"0.1.0"},ChordFactory.prototype={constructor:ChordFactory,_init:function(a){_.defaults(a,ChordFactory.DEFAULT_OPTIONS),this.parser=ChordParserPEG},chordFromDiv:function(a){var b=$(a);if(0!==b.length){var c=b.html(),d=b.attr("id");d||(d="chord-"+Math.round(1e9*Math.random()),b.attr("id",d)),this.chordFromString(b,c)}},chordFromString:function(a,b){if(!a||_.isString(a)&&""===a)throw TypeError("Must provide a valid DOM element or id string: "+a);if(_.isUndefined(b))throw TypeError("chordStr not provided: "+b);if(""===this._trim(b))throw TypeError("empty chordStr provided");var c;try{c=this.parser.parse(b)}catch(d){throw d}var e=$(a).attr("data-style");_.has(ChordView.OPTIONS,e)&&_.defaults(c.config,ChordView.OPTIONS[e]);var f=this._chordModelFromParseResult(c),g=this._chordViewFromParseResultAndModel(a,f,c);return g},_trim:function(a){return a.trim?a.trim():String(a).replace(/^\s+|\s+$/g,"")},_chordModelFromParseResult:function(a){var b,c={notes:[]};a.config&&_.defaults(c,a.config);{var d=new Tuning(c.tuning);d.getNumStrings()}if(a.strings)for(var e in a.strings){var f=a.strings[e];if(!_.isNumber(e)&&f.frets&&f.frets.length>0)for(b=0;b<f.frets.length;b++){var g=f.frets[b],h={};g.config&&_.defaults(h,g.config),h.finger=g.finger;var i=new GuitarNote(f.string,g.fret,h);c.notes.push(i)}}return new ChordModel(c)},_chordViewFromParseResultAndModel:function(a,b,c){var d={};return c.config&&_.defaults(d,c.config),new ChordView(a,d,b)},_isNumber:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},_isFloat:function(a){return this._isNumber(a)&&-1!=a.indexOf(".")}},ChordModel.DEFAULT_OPTIONS={label:"",tuning:"EADGBe"},ChordModel.prototype={constructor:ChordModel,_init:function(a){if(_.defaults(a,ChordModel.DEFAULT_OPTIONS),this.tuningStr=a.tuning,this.tuning=new Tuning(this.tuningStr),this.min_fret=-1,this.max_fret=-1,!_.isString(a.label))throw TypeError("label must be a string");this.label=a.label,this.notes={},a.notes&&(this.addNotes(a.notes),_.each(a.notes,function(a){this.notes[a.getKey()]=a},this))},getNotes:function(){return this.notes},getNumNotes:function(){return _.keys(this.notes).length},getNumStrings:function(){return this.tuning.getNumStrings()},getTuning:function(){return this.tuning},getLabel:function(){return this.label},getMinFret:function(){return this.min_fret},getMaxFret:function(){return this.max_fret},addNotes:function(a){if(!_.isArray(a))throw TypeError("addNotes takes an array of notes: "+a);for(var b=0;b<a.length;b++){var c=a[b];this.addNote(c)}},addNote:function(a){if(_.isUndefined(a)||_.isNull(a))throw TypeError("Note is undefined");if(!(a instanceof GuitarNote))throw TypeError("addNote requires a valid note string or GuitarNote object: "+a);if(a.string<0||a.string>=this.getNumStrings())throw TypeError("note stringNum is not valid for this chord: "+a.string);this.notes[a.getKey()]=a,_.isNumber(a.fret)&&0!==a.fret&&(-1==this.min_fret||a.fret<this.min_fret)&&(this.min_fret=a.fret),_.isNumber(a.fret)&&0!==a.fret&&(-1==this.max_fret||a.fret>this.max_fret)&&(this.max_fret=a.fret)},removeNote:function(a){var b=this._keyForNote(a);delete this.notes[b]},empty:function(){this.notes={}},transposeByInterval:function(a,b){var c={},d=a*b;for(var e in this.notes){var f=this.notes[e],g=f.fret+d;if(0>g)throw Error("Transposing causes negative fret values: "+a+" "+b);f.fret=g,c[f.getKey()]=f}this.notes=c,this.min_fret+=d,this.max_fret+=d},transposeToKey:function(a,b){if(!this.options.key&&!b)throw TypeError("No key assigned to chordmodel or passed as an argument")},equals:function(a){if(this.getNumStrings()!=a.getNumStrings()||this.getNumNotes()!=a.getNumNotes()||!this.getTuning().equals(a.getTuning())||this.getLabel()!=a.getLabel())return!1;var b,c,d=a.getNotes();for(var e in this.getNotes()){if(!_.has(d,e))return!1;if(b=this.getNotes()[e],c=d[e],!b.equals(c))return!1}return!0},toString:function(){var a,b=[];for(a=0;a<this.getTuning().notes.length;a++)b[a]=this.getTuning().notes[a]+" |--";for(var c in this.getNotes()){var d=this.notes[c];b[d.string]+=d.fret+"-"}for(a=0;a<this.getTuning().notes.length;a++)b[a]+="-|";return b.reverse().join("\n")},_keyForNote:function(a){if(!(a instanceof GuitarNote))throw TypeError("addNote requires a valid note string or GuitarNote object: "+a);return a.string+" "+a.fret}},ChordParser.DEFAULT_OPTIONS={version:"0.1.0"},ChordParser.prototype={constructor:ChordParser,_init:function(a){_.defaults(a,ChordParser.DEFAULT_OPTIONS)},parseChord:function(a,b){if(b=b.replace(/^\s+|\s+$/g,""),""!==b){var c={},d=[],e=b.split("\n");_.each(e,function(a){if(""!==a){if(-1!=a.indexOf("["))return c=this._parseConfigString(a),void 0;var b=this._parseStringString(a);d.push(b)}},this);var f=new ChordModel,g=new ChordView(a,c,f);return g}},_parseConfigString:function(a){var b={};a=a.replace(/^\[|\]$/g,"");var c=a.split(",");return _.each(c,function(a){a=a.replace(/^\s+|\s+$/g,"");var c=a.split("="),d=c[0],e=c[1];b[d]=this._isNumber(e)&&this._isFloat(e)?parseFloat(e):this._isNumber(e)?parseInt(e,10):e}),b},_parseStringString:function(a){var b={notes:[]},c=/\s*(\d{1,2}):/,d=parseInt(a.match(c)[1].replace(/^\s+|\s+$/g,""),10);b.stringNum=d;var e=a.replace(c,""),f=e.split(",");_.each(f,function(a){var c=this._parseNoteString(a);b.notes.push(_.clone(c))})},_parseNoteString:function(a){var b,c={},d=/\(.*\)/g,e=a.match(d);if(e){var f=e[0];a=a.replace(f,""),f=f.replace(/^\(|\)$/g,"");var g=f.split(";");_.each(g,function(a){if(""!==a){var c=a.split(":"),d=c[0].replace(/^\s+|\s+$/g,""),e=c[1].replace(/^\s+|\s+$/g,"");"color"==d&&(b=e)}})}if(-1!=a.indexOf("{")){a=a.replace(/[{|}]/g,"");var h=a.split(" ");c.fret=h[0].replace(/^\s+|\s+$/g,""),h[1]&&(c.finger=h[1])}else c.fret=a.replace(/^\s+|\s+$/g,"");return c.fret.match(/^[oO0]$/)?(c.fret=0,c.open=!0):c.fret.match(/[mMxX]/)?c.muted=!0:c.fret=parseInt(c.fret,10),c.color=b,c},_isNumber:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},_isFloat:function(a){return this._isNumber(a)&&-1!=a.indexOf(".")}},ChordView.NUT_TOP=-1,ChordView.NUT_LEFT=-2,ChordView.FINGER_TOP=-1,ChordView.FINGER_LEFT=-2,ChordView.FINGER_ONNOTE=-3,ChordView.NOTE_COLORS={black:"#000",white:"#fff",blue:"#22f",red:"#f22",green:"#0f0"},ChordView.NOTE_GRADIENTS={black:"90-#000:5-#555:95",white:"90-#eee:5-#fff:95",blue:"90-#22f:5-#55f:95",red:"90-#f22:5-#f55:95",green:"90-#0f0:5-#0f0:95"},ChordView.NECK_MARKERS=[[5,1],[7,2],[9,1],[12,2],[15,1],[17,1]],ChordView.UNSCALABLE=["base_fret","num_frets","min_frets","fret_pad","scale","orientation","finger_position"],ChordView.DEFAULT_OPTIONS={scale:.5,orientation:ChordView.NUT_TOP,string_gap:30,fret_gap:30,fret_pad:1,min_frets:5,show_fingers:!0,finger_anno_y:10,finger_position:ChordView.FINGER_TOP,anno_font_size:18,open_note_radius:6,note_radius:10,note_stroke_width:1.5,note_gradient:!0,note_color:"white",tonic_color:"black",neck_marker_radius:8,neck_marker_color:"#eee",nut_height:5,grid_x:0,grid_y:0,grid_stroke_width:1.5,grid_padding_bottom:20,grid_padding_right:20,grid_padding_left:20,show_label:!0,label_font_size:36,label_y_offset:20,label_height:40,show_tuning:!0,tuning_label_font_size:18,tuning_label_offset:14,base_fret_font_size:26,base_fret_label_width:20,base_fret_offset:16},ChordView.OPTIONS_COMPACT={scale:.3,show_tuning:!1,show_fingers:!1,note_stroke_width:1,note_color:"black",note_gradient:!1,base_fret_font_size:36,base_fret_offset:20,grid_padding_right:40,num_frets:5},ChordView.OPTIONS_NECK={scale:1,orientation:ChordView.NUT_LEFT,show_tuning:!0,fret_gap:50,num_frets:15},ChordView.OPTIONS={"default":ChordView.DEFAULT_OPTIONS,compact:ChordView.OPTIONS_COMPACT,neck:ChordView.OPTIONS_NECK},ChordView.prototype={constructor:ChordView,_init:function(a,b,c){if(_.isString(a))this.containerId=a.replace("#","");else if(a instanceof jQuery)this.containerId=a.attr("id");else{if(!_.isElement(a))throw TypeError("container must be a DOM elem or DOM ID string.");this.containerId=$(a).attr("id")}if(this.options={},_.isString(b)){if(!_.has(ChordView.OPTIONS,b))throw TypeError("Invalid options string: "+b);_.defaults(this.options,ChordView.OPTIONS[b])}else _.isObject(b)&&_.defaults(this.options,b);_.defaults(this.options,ChordView.DEFAULT_OPTIONS),this.model=c,this.options.grid_x=this.options.grid_padding_left,this.options.grid_y=this.options.anno_font_size+4,this.options.orientation===ChordView.NUT_TOP&&""!==this.model.getLabel()&&(this.options.grid_y+=this.options.label_height),1!=this.options.scale&&this._scaleSize(),_.has(this.options,"num_frets")&&_.has(this.options,"base_fret")||this._calcFretRange(),this.diagram_glyphs={},this.neck={glyphs:{},width:0,height:0},this.noteGlyphs={},this.transform_str="",this.width=this.options.grid_x+this.model.getNumStrings()*this.options.string_gap+this.options.base_fret_label_width+this.options.grid_padding_right,this.height=this.options.grid_y+this.options.num_frets*this.options.fret_gap+this.options.tuning_label_font_size+this.options.grid_padding_bottom,window.jQuery?$(a).html(""):_.isElement(a)&&(a.innerHtml=""),this.r=null,this.r=Raphael(this.containerId,this.width,this.height),this._render(),this._setOrientation(this.options.orientation);var d=$("#"+this.containerId).width(),e=$("#"+this.containerId).parent().width();d>e&&$("#"+this.containerId).css("width",""+e+"px")},getCode:function(){throw Error("Not implemented yet")},getModel:function(){return this.model},_scaleSize:function(){_.each(ChordView.DEFAULT_OPTIONS,function(a,b){-1==_.indexOf(ChordView.UNSCALABLE,b)&&_.isNumber(this.options[b])&&(this.options[b]=this.options[b]*this.options.scale)},this)},_calcFretRange:function(){var a=this.model.getMaxFret()-this.model.getMinFret(),b=a+this.options.fret_pad,c=Math.max(this.model.getMinFret(),1);_.has(this.options,"base_fret")||(this.options.base_fret=c),_.has(this.options,"num_frets")||(this.options.num_frets=Math.max(this.options.min_frets,b+(c-this.options.base_fret)))},_render:function(){this.neck.width=(this.model.getNumStrings()-1)*this.options.string_gap,this.neck.height=this.options.num_frets*this.options.fret_gap,this._drawNeck(this.options.grid_x,this.options.grid_y,this.neck.width,this.neck.height,this.model.getNumStrings()-1,this.options.num_frets,"#000"),1==this.options.base_fret?this._drawNut():this._drawBaseFret(this.options.base_fret),this.options.orientation===ChordView.NUT_TOP&&this.options.show_label&&this._drawLabel(),this.options.show_tuning&&this._drawTuningLabel(),this._drawNotes()},_setOrientation:function(a){if(_.isString(a)){if("left"==a)return this._setOrientation(ChordView.NUT_LEFT),void 0;if("top"==a)return this._setOrientation(ChordView.NUT_TOP),void 0;throw TypeError("Invalid orientation string: "+a)}if(!_.include([ChordView.NUT_TOP,ChordView.NUT_LEFT],a))throw TypeError("Invalid orientation: "+a);if(a==ChordView.NUT_TOP)this.transform_str="",this.width=this.options.grid_x+this.model.getNumStrings()*this.options.string_gap+this.options.base_fret_label_width+this.options.grid_padding_right,this.height=this.options.grid_y+this.options.num_frets*this.options.fret_gap+this.options.tuning_label_font_size+this.options.grid_padding_bottom,this.r.setSize(this.width,this.height);else if(a==ChordView.NUT_LEFT){{this.options.grid_x+this.neck.width/2,this.options.grid_y+this.neck.height/2,-(this.width-this.height)/2,(this.height-this.width)/2}this.transform_str="r-90,0,0t-"+(this.width-(this.options.base_fret_label_width+this.options.grid_padding_right))+",0",this.height=this.options.grid_x+this.model.getNumStrings()*this.options.string_gap,this.width=this.options.grid_y+this.options.num_frets*this.options.fret_gap+this.options.tuning_label_font_size+this.options.grid_padding_bottom,this.r.setSize(this.width,this.height)}_.each(_.values(this.neck.glyphs),function(a){_.isArray(a)?_.each(a,function(a){a.transform(this.transform_str)},this):a.transform(this.transform_str)},this),_.each(_.values(this.noteGlyphs),function(b){_.each(_.values(b),function(b){a==ChordView.NUT_LEFT?b.transform(this.transform_str+"r90"):b.transform(this.transform_str)},this)},this)},_drawNeck:function(a,b,c,d,e,f,g){g=g||"#000";for(var h=["M",Math.round(a)+.5,Math.round(b)+.5,"L",Math.round(a+c)+.5,Math.round(b)+.5,Math.round(a+c)+.5,Math.round(b+d)+.5,Math.round(a)+.5,Math.round(b+d)+.5,Math.round(a)+.5,Math.round(b)+.5],i=d/f,j=c/e,k=1;f>k;k++)h=h.concat(["M",Math.round(a)+.5,Math.round(b+k*i)+.5,"H",Math.round(a+c)+.5]);for(k=1;e>k;k++)h=h.concat(["M",Math.round(a+k*j)+.5,Math.round(b)+.5,"V",Math.round(b+d)+.5]);this._drawNeckMarkers(),this.neck.glyphs.grid=this.r.path(h.join(",")).attr({stroke:g,"stroke-width":this.options.grid_stroke_width})},_drawNeckMarkers:function(){this.neck.glyphs["neck-markers"]=[];for(var a=0;a<ChordView.NECK_MARKERS.length;a++){var b=ChordView.NECK_MARKERS[a];b[0]>this.options.base_fret&&b[0]<this.options.base_fret+this.options.num_frets&&this._drawNeckMarker(b)}},_drawNeckMarker:function(a){if(!_.isUndefined(a)){var b=this.options.grid_y+(a[0]-(this.options.base_fret-1))*this.options.fret_gap-this.options.fret_gap/2,c={fill:this.options.neck_marker_color,stroke:"none"};if(1==a[1]){var d=this.options.grid_x+this.neck.width/2,e=this.r.circle(d,b,this.options.neck_marker_radius);e.attr(c),this.neck.glyphs["neck-markers"].push(e)}else if(2==a[1]){var f=this.options.grid_x+1.2*this.options.string_gap,g=this.options.grid_x+3.8*this.options.string_gap,h=this.r.circle(f,b,this.options.neck_marker_radius);h.attr(c),this.neck.glyphs["neck-markers"].push(h);var i=this.r.circle(g,b,this.options.neck_marker_radius);i.attr(c),this.neck.glyphs["neck-markers"].push(i)}}},_drawNut:function(){var a=this.r.rect(this.options.grid_x,this.options.grid_y,(this.model.getNumStrings()-1)*this.options.string_gap,this.options.nut_height).attr({fill:"black"});this.neck.glyphs.nut=a},_drawTuningLabel:function(){var a={"font-size":this.options.tuning_label_font_size};this.neck.glyphs["tuning-labels"]=[];for(var b=0;b<this.model.getNumStrings();b++){var c=this.model.getTuning().notes[b],d=this.options.grid_x+b*this.options.string_gap,e=this.options.grid_y+this.neck.height+this.options.tuning_label_offset,f=this.r.text(d,e,""+c).attr(a);this.neck.glyphs["tuning-labels"].push(f)}},_drawBaseFret:function(a){var b=this.options.grid_x+this.neck.width+this.options.base_fret_offset,c=this.options.grid_y+this.options.fret_gap/2;this.r.text(b,c,""+a+"fr.").attr({"text-anchor":"start","font-size":this.options.base_fret_font_size})},_drawNotes:function(){_.each(this.model.getNotes(),this._drawNote,this)},_drawNote:function(a){if(_.isUndefined(a)||_.isNull(a))throw TypeError("Model has undefined note");if(a instanceof GuitarNote)if(_.isUndefined(this.noteGlyphs[a.getKey()])&&(this.noteGlyphs[a.getKey()]={}),a.isMuted())this._drawMuteStringAnnotatation(a).transform(this.transform_str);else if(a.isOpen())this._drawOpenStringAnnotatation(a).transform(this.transform_str);else{var b=this._drawFretMarker(a);b&&b.transform(this.transform_str),this.options.show_fingers&&a.finger&&this._drawFingerAnnotation(a).transform(this.transform_str)}},_drawFretMarker:function(a){if(!_.isUndefined(a.fret)&&0!==a.fret&&!(a.fret<this.options.base_fret||a.fret>=this.options.base_fret+this.options.num_frets)){var b=this.options.grid_x+a.string*this.options.string_gap+.5,c=this.options.grid_y+(a.fret-this.options.base_fret+1)*this.options.fret_gap-this.options.fret_gap/2+.5,d={fill:this._colorValueForName(this.options.note_color)};d["stroke-width"]=this.options.note_stroke_width,a.options.color&&(d.fill=this._colorValueForName(a.options.color)),a.options.tonic&&(d.fill=this._colorValueForName(this.options.tonic_color),d.stroke="black");var e="chord-note";a.class&&(e=e+" "+a.class);var f=this.r.circle(b,c,this.options.note_radius);return f.node.setAttribute("class",e),f.attr(d),this.noteGlyphs[a.getKey()]["fret-marker"]=f,f}},_drawMuteStringAnnotatation:function(a){if(!_.isUndefined(a.string)){var b=this.options.grid_x+a.string*this.options.string_gap,c=this.options.grid_y-this.options.finger_anno_y,d=this.r.text(b,c,"X").attr({"font-size":this.options.anno_font_size});return this.noteGlyphs[a.getKey()]["finger-annotation"]=d,d}},_drawOpenStringAnnotatation:function(a){if(!_.isUndefined(a.string)){var b=this.options.grid_x+a.string*this.options.string_gap,c=this.options.grid_y-this.options.finger_anno_y,d=this.r.circle(b,c,this.options.open_note_radius).attr({stroke:"black",fill:"white","stroke-width":this.options.note_stroke_width});return this.noteGlyphs[a.getKey()]["finger-annotation"]=d,d}},_drawFingerAnnotation:function(a){if(!_.isUndefined(a.string)&&!_.isUndefined(a.finger)){var b,c,d={"font-size":this.options.anno_font_size};if(this.options.finger_position===ChordView.FINGER_TOP)b=this.options.grid_x+a.string*this.options.string_gap,c=this.options.grid_y-this.options.finger_anno_y;else if(this.options.finger_position===ChordView.FINGER_LEFT)b=this.options.grid_x+a.string*this.options.string_gap-2*this.options.note_radius+.5,c=this.options.grid_y+(a.fret-this.options.base_fret+1)*this.options.fret_gap-this.options.fret_gap/2+.5;else{if(this.options.finger_position!==ChordView.FINGER_ONNOTE)throw TypeError("Invalid finger_position: "+this.options.finger_position);b=this.options.grid_x+a.string*this.options.string_gap+.5,c=this.options.grid_y+(a.fret-this.options.base_fret+1)*this.options.fret_gap-this.options.fret_gap/2+.5}var e=this.r.text(b,c,""+a.finger).attr(d);return this.noteGlyphs[a.getKey()]["finger-annotation"]=e,e}},_drawLabel:function(){var a=this.options.grid_x+this.neck.width/2,b=this.options.label_y_offset,c=this.model.getLabel().replace(/b/g,"♭").replace(/\#/g,"♯").replace(/\*/g,"￮");this.r.text(a,b,c).attr({"text-anchor":"middle","font-size":this.options.label_font_size})},_colorValueForName:function(a){return this.options.note_gradient?ChordView.NOTE_GRADIENTS[a]:ChordView.NOTE_COLORS[a]}},GuitarNote.DEFAULT_OPTIONS={muted:!1,finger:null},GuitarNote.DEF_MUTE_ANNOTATION="x",GuitarNote.MUTE_ANNOTATION="xXmM",GuitarNote.THUMB_ANNOTATION="tT",GuitarNote.prototype={constructor:GuitarNote,_init:function(a,b,c){if(this.options=c,_.defaults(this.options,GuitarNote.DEFAULT_OPTIONS),void 0===a||null===a||!_.isNumber(a)||0>a)throw TypeError("Please provide a valid string number >= 0: "+a);if(!(this.options.muted||void 0!==b&&null!==b))throw TypeError("Please provide a valid fret: "+b);if(!(this.options.muted||_.isNumber(b)||this.isMuteAnnotation(b)))throw TypeError("Please provide a valid fret: "+b);if(_.isNumber(b)&&0>b)throw TypeError("Fret number must be >= 0: "+b);(this.isMuteAnnotation(b)||this.options.finger&&this.isMuteAnnotation(this.options.finger))&&(this.options.muted=!0),this.string=a,this.fret=b,this.finger=this.options.finger},isOpen:function(){return 0===this.fret},isMuted:function(){return this.options.muted?!0:!1},getKey:function(){return this.isMuted()?this.string+" "+GuitarNote.DEF_MUTE_ANNOTATION:this.string+" "+this.fret},equals:function(a){return a&&this.string===a.string&&this.fret===a.fret&&this.finger===a.finger?this.isMuted()!=a.isMuted()?!1:!0:!1},isMuteAnnotation:function(a){return-1!==GuitarNote.MUTE_ANNOTATION.indexOf(a)},isThumbAnnotation:function(a){return-1!==GuitarNote.THUMB_ANNOTATION.indexOf(a)},toString:function(){var a="String: "+this.string+", Fret: "+this.fret;return this.isMuted()?a+=", Finger: "+GuitarNote.DEF_MUTE_ANNOTATION:this.finger&&(a+=", Finger: "+this.finger),a}},GuitarNoteFactory.DEFAULT_OPTIONS={tuning:"EADGBe",numFrets:20,minFret:0,maxFret:20},GuitarNoteFactory.prototype={constructor:GuitarNoteFactory,_init:function(a){if(_.defaults(a,GuitarNoteFactory.DEFAULT_OPTIONS),!a.numFrets||!_.isNumber(a.numFrets)||a.numFrets<0)throw TypeError("numFrets must be valid number >= 0");this.tuning=new Tuning(a.tuning),this.numFrets=a.numFrets,this.minFret=a.minFret,this.maxFret=a.maxFret,this.numFrets<this.maxFret&&(this.maxFret=this.numFrets),this.music=new Aex.Flow.Music},notesForNotesValues:function(a){if(!a||!_.isArray(a))throw TypeError("notesValues must be an array");for(var b=[],c=0;c<a.length;c++){var d=a[c];if(!_.isNumber(d))throw TypeError("noteValue must be a number: "+d);if(0>d||d>=Aex.Flow.Music.NUM_TONES)throw TypeError("noteValue must be 0 <= noteVal < 12: "+d);for(var e=0;e<this.tuning.getNumStrings();e++)for(var f=this.tuning.notes[e].toLowerCase(),g=this.music.getNoteValue(f),h=this.minFret;h<this.maxFret;h++){var i=(g+h)%12;if(d===i){var j=new GuitarNote(e,h);b.push(j)}}}return b},notesForNotesStr:function(a){for(var b=a.split(" "),c=[],d=0;d<b.length;d++){var e=b[d].toLowerCase();if(""!==e){if(!_.has(Aex.Flow.Music.noteValues,e))throw TypeError("Invalid noteStr in notesStr: "+e+" in "+a);var f=this.music.getNoteValue(e);c.push(f)}}return this.notesForNotesValues(c)},notesForScale:function(a,b){if(_.isUndefined(a)||_.isNull(a)||!_.isString(a)||""===a)throw TypeError("Key is required.");if(!a||!_.has(Aex.Flow.Music.noteValues,a))throw TypeError("Invalid key: "+a);if(!b||!_.isString(b)||!_.has(Aex.Flow.Music.scales,b))throw TypeError("Invalid scale: "+b);var c=a.toLowerCase(),d=this.music.getNoteValue(c),e=Aex.Flow.Music.scales[b],f=[],g=d;f.push(d);for(var h=0;h<e.length;h++){var i=(g+e[h])%12;f.push(i),g=i}return this.notesForNotesValues(f)},notesForArpeggio:function(a,b){if(_.isUndefined(a)||_.isNull(a)||!_.isString(a)||""===a)throw TypeError("Key is required.");if(!a||!_.has(Aex.Flow.Music.noteValues,a))throw TypeError("Invalid key: "+a);if(!b||!_.isString(b)||!_.has(Aex.Flow.Music.arpeggios,b))throw TypeError("Invalid scale: "+b);var c=a.toLowerCase(),d=this.music.getNoteValue(c),e=Aex.Flow.Music.arpeggios[b],f=[],g=d;f.push(d);for(var h=0;h<e.length;h++){var i=(g+e[h])%12;f.push(i),g=i}return this.notesForNotesValues(f)}},Tuning.prototype={constructor:Tuning,_init:function(a){if(a||(a=Tuning.defaultTuning),!Tuning.isValidTuningString(a))throw TypeError("Invalid tuningStr: "+a);this.tuningStr=a,this.notes=Tuning.parseTuningString(a)},getNumStrings:function(){return this.notes.length},noteValForString:function(a){var b=new Aex.Flow.Music;return b.getNoteValue(this.noteNameForString(a))},noteNameForString:function(a){return this.notes[a]},equals:function(a){if(this.getNumStrings()!==a.getNumStrings())return!1;for(var b=0;b<this.getNumStrings();b++)if(this.notes[b]!==a.notes[b])return!1;return!0},toString:function(){return this.tuningStr}},Tuning.isValidTuningString=function(a){return a&&_.isString(a)&&0!==a.length?null!==a.match(/^([abcdefg#]\s?)+$/gi):!1},Tuning.parseTuningString=function(a){if(!Tuning.isValidTuningString(a))throw TypeError("Invalid tuning string: "+a);if(null!==a.match(/(bb[ABCDEFGabcdefg])|(b[ABCDEFGacdefg])/g))throw TypeError("Ambiguous tuning string. Flats confused with B Notes.  Use spaces between notes: "+a);var b=[],c=a.split(" ");for(var d in c)for(var e=c[d],f=e.match(/[ABCDEFGabcdefg](bb|b|n|##|#)?/g),g=0;g<f.length;g++)b.push(f[g]);return b},Tuning.instruments={guitar:{"default":"EADGBe",standard:"EADGBe","drop-d":"DADGBe","open-g":"DGDGBD","open-g-dobro":"GBDGBD","open-d":"DADF#AD"},banjo:{"default":"gDGBD","open-g":"gDGBD","g-modal":"gDGCD","open-g-minor":"gDGA#D","standard-c":"gCGBD","open-d":"f#DF#AD"},mandolin:{"default":"GDAE"},bass:{"default":"EADG"}},Tuning.defaultTuning=Tuning.instruments.guitar["default"],TuningFactory.fromInstrument=function(a,b){if(!a||!_.isString(a))throw TypeError("Must provide an instrument string");if(a=a.toLowerCase(),!_.has(Tuning.instruments,a))throw TypeError("Invalid instrument");if(b){if(!_.isString(b))throw TypeError("tuning_type must be a string")}else b="default";if(b=b.toLowerCase(),!_.has(Tuning.instruments[a],b))throw TypeError("Invalid tuning type: "+b);return new Tuning(Tuning.instruments[a][b])},Voicings.voicings={guitar:{eadgbe:[{key:"c",label:"maj",notes:[3,3,5,5,5,"x"],fingers:[1,1,3,3,3,"x"],bass:7,tags:"gypsy"},{key:"c",label:"maj",notes:[8,10,10,9,8,8],fingers:["T",3,4,2,1,1],tags:"gypsy"},{key:"c",label:"maj",notes:[12,"x",10,12,13,"x"],fingers:[2,"x",1,3,4,"x"],bass:4,tags:"gypsy"},{key:"c",label:"maj",notes:[12,"x",14,12,13,"x"],fingers:["T","x",3,1,2,"x"],bass:4,tags:"gypsy"},{key:"c",label:"maj7",notes:["x",3,5,4,5,"x"],fingers:["x",1,3,2,4,"x"],tags:"jazz"},{key:"c",label:"maj7",notes:["x",3,5,4,5,3],fingers:["x",1,3,2,4,1],tags:"jazz"},{key:"c",label:"maj7",notes:["x",3,2,4,5,"x"],fingers:["x",2,1,3,4,"x"],tags:"jazz"},{key:"c",label:"maj7",notes:["x",3,5,5,5,7],fingers:["x",1,3,3,3,4],tags:"jazz"},{key:"g",label:"maj7",notes:[3,"x",4,4,3,"x"],fingers:[1,"x",3,4,2,"x"],tags:"jazz"},{key:"g",label:"maj7",notes:[3,5,"x",4,7,"x"],fingers:[1,3,"x",2,4,"x"],tags:"jazz"},{key:"g",label:"maj7",notes:[7,"x",5,7,7,"x"],fingers:[2,"x",1,3,4,"x"],bass:4,tags:"jazz"},{key:"g",label:"maj7",notes:["x",10,9,7,7,7],fingers:["x",4,3,1,1,1],tags:"jazz"},{key:"c",label:"maj7",notes:["x","x",10,9,8,7],fingers:["x","x",4,3,2,1],tags:"jazz"},{key:"g",label:"maj7",notes:["x",2,4,4,3,"x"],fingers:["x",1,3,4,2,"x"],base:4,tags:"jazz"},{key:"g",label:"6",notes:[3,"x",2,4,3,"x"],fingers:[2,"x",1,4,3,"x"],tags:"jazz"},{key:"g",label:"6",notes:[3,5,"x",4,5,"x"],fingers:[1,3,"x",2,4,"x"],tags:"jazz"},{key:"g",label:"6",notes:["x",7,5,7,5,"x"],fingers:["x",3,1,4,1,"x"],base:9,tags:"jazz"},{key:"g",label:"6",notes:["x",7,5,4,3,"x"],fingers:["x",4,3,2,1,"x"],base:9,tags:"jazz"},{key:"g",label:"6",notes:["x",7,5,4,3,3],fingers:["x",4,3,2,1,1],base:9,tags:"jazz"},{key:"g",label:"6",notes:["x",7,9,9,8,7],fingers:["x",1,3,4,2,1],base:9,tags:"jazz"},{key:"g",label:"6",notes:["x",7,9,7,8,"x"],fingers:["x",1,3,1,2,"x"],base:9,tags:"jazz"},{key:"c",label:"6",notes:["x",4,3,3,6,"x"],fingers:["x",2,1,1,4,"x"],tags:"jazz"},{key:"c",label:"6",notes:["x",3,5,5,5,5],fingers:["x",1,3,3,3,3],tags:"jazz"},{key:"d",label:"6",notes:["x",5,4,4,3,"x"],fingers:["x",4,2,3,1,"x"],tags:"jazz"},{key:"c",label:"6",notes:[3,3,5,5,5,5],fingers:[1,1,3,3,3,3],bass:7,tags:"gypsy"},{key:"c",label:"6",notes:[8,7,5,5,5,5],fingers:[4,3,1,1,1,1],tags:"gypsy"},{key:"c",label:"6",notes:[8,"x",10,9,10,8],fingers:["T","x",3,2,4,1],tags:"gypsy"},{key:"f",label:"maj9",notes:[5,7,5,5,5,8],fingers:[1,3,1,1,1,4],bass:4,tags:"jazz"},{key:"f",label:"maj9",notes:[5,7,5,5,8,"x"],fingers:[1,3,1,1,4,"x"],bass:4,tags:"jazz"},{key:"c",label:"maj9",notes:["x",3,2,4,3,"x"],fingers:["x",2,1,4,3],tags:"jazz"},{key:"a",label:"maj9",notes:["x",4,6,4,5,"x"],fingers:["x",1,3,1,2,"x"],bass:4,tags:"jazz"},{key:"a",label:"maj9",notes:["x",4,6,4,5,7],fingers:["x",1,3,1,2,4],bass:4,tags:"jazz"},{key:"c",label:"6/9",notes:["x",3,2,2,3,3],fingers:["x",2,1,1,3,3],tags:"jazz"},{key:"g",label:"6/9",notes:[3,"x",2,2,3,3],fingers:[2,"x",1,1,3,3],tags:"jazz"},{key:"d",label:"6/9",notes:["x",2,2,2,3,"x"],fingers:["x",1,1,1,2,"x"],bass:9,tags:"jazz"},{key:"c",label:"6/9",notes:[3,3,2,2,3,3],fingers:[2,2,1,1,3,4],bass:7,tags:"gypsy"},{key:"c",label:"6/9",notes:[8,7,7,7,8,8],fingers:[2,1,1,1,3,4],tags:"gypsy"},{key:"c",label:"6/9",notes:[8,10,10,9,10,10],fingers:["T",2,2,1,3,3],tags:"gypsy"},{key:"f",label:"7",notes:["x","x",5,4,5,3],fingers:["x","x",3,2,4,1],tags:"jazz"},{key:"f",label:"7",notes:["x",5,7,7,7,8],fingers:["x",1,3,3,3,4],tags:"jazz"},{key:"c",label:"7",notes:[3,3,5,3,5,3],fingers:[1,1,3,1,4,1],tags:"gypsy"},{key:"c",label:"7",notes:[8,"x",8,9,8,"x"],fingers:["T","x",1,3,2,"x"],tags:"gypsy"},{key:"c",label:"7",notes:[8,10,8,9,8,8],fingers:[1,3,1,2,1,1],tags:"gypsy"},{key:"c",label:"7",notes:[3,3,2,3,1,"x"],fingers:[3,3,2,4,1,"x"],bass:7,tags:"gypsy"},{key:"c",label:"7",notes:[8,10,10,9,11],fingers:["T",2,2,1,4,"x"],tags:"gypsy"},{key:"c",label:"7",notes:[6,"x",5,5,5,"x"],fingers:[2,"x",1,1,1,"x"],bass:10,tags:"gypsy"},{key:"c",label:"7",notes:[3,3,5,3,5,6],fingers:[1,1,2,1,3,4,"x"],bass:7,tags:"gypsy"},{key:"c",label:"7",notes:[8,"x",8,9,8,8],fingers:["T","x",1,4,2,3],tags:"gypsy"},{key:"b",label:"7(b5)",notes:[7,"x",7,8,6,"x"],fingers:[2,"x",3,4,1,"x"],tags:"jazz"},{key:"d",label:"7(b5)",notes:[4,"x",4,5,3,"x"],fingers:[2,"x",3,4,1,"x"],bass:6,tags:"jazz"},{key:"a",label:"7(#5)",notes:[5,"x",5,6,6,"x"],fingers:[1,"x",2,3,4,"x"],tags:"jazz"},{key:"a",label:"7(#5)",notes:[5,"x",5,6,6,"x"],fingers:["T","x",1,2,2,"x"],tags:"jazz"},{key:"d",label:"7(#5)",notes:["x",5,4,5,"x",6],fingers:["x",2,1,3,"x",4],tags:"jazz"},{key:"bb",label:"7(b9)",notes:[6,"x",6,7,6,7],fingers:["T","x",1,3,2,4],tags:"jazz"},{key:"e",label:"7(b9)",notes:["x",7,6,7,6,"x"],fingers:["x",2,1,3,1,"x"],tags:"jazz"},{key:"c",label:"7(b9)",notes:[3,3,2,3,2,"x"],fingers:[2,2,1,3,1,"x"],bass:7,tags:"gypsy jazz"},{key:"c",label:"7(b9)",notes:[12,"x",14,12,14,"x"],fingers:["T","x",2,1,3,"x"],bass:4,tags:"gypsy jazz"},{key:"c",label:"9",notes:["x",3,2,3,3,"x"],fingers:["x",2,1,3,3,"x"],tags:"jazz"},{key:"c",label:"9",notes:["x",3,2,3,3,3],fingers:["x",2,1,3,3,3],tags:"jazz"},{key:"g",label:"9",notes:[3,5,3,4,3,5],fingers:[1,3,1,2,1,4],tags:"jazz"},{key:"g",label:"9",notes:["x",2,3,2,3,"x"],fingers:["x",1,3,2,4,"x"],bass:4,tags:"jazz"},{key:"d",label:"11",notes:[5,"x",5,5,3,"x"],fingers:[2,"x",3,4,1,"x"],bass:7,tags:"jazz"},{key:"g",label:"11",notes:["x",5,3,5,3,3],fingers:["x",3,1,4,1,1],bass:7,tags:"jazz"},{key:"c",label:"11",notes:["x",3,5,3,6,"x"],fingers:["x",1,3,1,4,"x"],tags:"jazz"},{key:"a",label:"13",notes:[5,"x",5,6,7,"x"],fingers:[1,"x",2,3,4,"x"],tags:"jazz"},{key:"a",label:"13",notes:[5,"x",5,6,7,"x"],fingers:["T","x",1,2,4,"x"],tags:"jazz"},{key:"a",label:"13",notes:["x",10,9,6,7,"x"],fingers:["x",4,3,1,2,"x"],bass:11,tags:"jazz"},{key:"d",label:"13",notes:["x",5,4,5,5,7],fingers:["x",2,1,3,3,4],tags:"jazz"},{key:"d",label:"13",notes:["x","x",10,9,7,7],fingers:["x","x",4,3,1,1],bass:11,tags:"jazz"},{key:"c",label:"m",notes:[3,3,5,5,4,3],fingers:[1,1,3,4,2,1],bass:7,tags:"gypsy"},{key:"c",label:"m",notes:[8,10,10,8,8,8],fingers:["T",3,4,1,1,1],tags:"gypsy"},{key:"c",label:"m",notes:[11,"x",10,12,13],fingers:[2,"x",1,3,4,"x"],bass:3,tags:"gypsy"},{key:"c",label:"m",notes:[11,"x",13,12,13,"x"],fingers:["T","x",2,1,3,"x"],bass:3,tags:"gypsy"},{key:"c",label:"m7",notes:[8,"x",8,8,8,"x"],fingers:[2,"x",3,3,3,"x"],tags:"jazz"},{key:"e",label:"m7",notes:["x",7,5,7,5,"x"],fingers:["x",3,1,4,1,"x"],tags:"jazz"},{key:"e",label:"m7",notes:["x",7,9,7,8,"x"],fingers:["x",1,3,1,2,"x"],tags:"jazz"},{key:"e",label:"m7",notes:["x",7,9,7,8,7],fingers:["x",1,3,1,2,1],tags:"jazz"},{key:"e",label:"m7",notes:["x",7,9,7,8,10],fingers:["x",1,3,1,2,4],tags:"jazz"},{key:"e",label:"m7",notes:["x",7,5,7,8,"x"],fingers:["x",2,1,3,4,"x"],tags:"jazz"},{key:"b",label:"m7",notes:[7,9,7,7,7,10],fingers:[1,3,1,1,1,4],tags:"jazz"},{key:"b",label:"m7",notes:[7,9,7,7,10,"x"],fingers:[1,3,1,1,4,"x"],tags:"jazz"},{key:"c",label:"m7",notes:[8,"x",8,8,8,8],fingers:[2,"x",3,3,3,3],tags:"gypsy jazz"},{key:"c",label:"m7",notes:[3,3,5,3,4,3],fingers:[1,1,3,1,2,1],bass:7,tags:"gypsy"},{key:"c",label:"m7",notes:[3,"x",1,3,4,"x"],fingers:[3,"x",1,3,4,"x"],bass:7,tags:"gypsy"},{key:"c",label:"m7",notes:[8,10,8,8,8,8],fingers:["T",3,1,1,1,1],tags:"gypsy"},{key:"c",label:"m7(b5)",notes:["x",3,4,3,4,"x"],fingers:["x",1,3,2,4,"x"],tags:"gypsy"},{key:"c",label:"m7(b5)",notes:[8,"x",8,8,7,"x"],fingers:[2,"x",3,4,1,"x"],tags:"gypsy"},{key:"c",label:"m7(b5)",notes:[11,"x",10,11,11,11],fingers:[2,"x",1,3,3,3],bass:3,tags:"gypsy"},{key:"c",label:"m7(b5)",notes:[11,13,13,11,13,"x"],fingers:["T",2,2,1,3,"x"],bass:3,tags:"gypsy"},{key:"c",label:"m7(b5)",notes:[8,"x",8,8,7,8],fingers:["T","x",2,2,1,3],tags:"gypsy"},{key:"c",label:"m6",notes:[5,6,7,8,8,8],fingers:[1,2,3,4,4,4],bass:9,tags:"jazz"},{key:"c",label:"m6",notes:[5,"x",5,5,4,"x"],fingers:[2,"x",3,4,1,"x"],bass:9,tags:"jazz"},{key:"c",label:"m6",notes:[5,"x",4,5,5,"x"],fingers:[2,"x",1,3,3,"x"],tags:"jazz"},{key:"c",label:"m6",notes:[8,"x",7,8,8,8],fingers:[2,"x",1,3,3,3],tags:"gypsy"},{key:"c",label:"m6",notes:["x",12,13,12,13,"x"],fingers:["x",1,3,2,4,"x"],bass:9,tags:"gypsy jazz"},{key:"c",label:"m6",notes:[3,3,5,5,4,5],fingers:[1,1,3,1,2,1],bass:7,tags:"gypsy"},{key:"c",label:"m6",notes:[8,10,10,8,10,"x"],fingers:["T",2,2,1,3,"x"],tags:"gypsy"},{key:"c",label:"m6",notes:[8,"x",10,8,10,"x"],fingers:["T","x",3,1,4,"x"],tags:"gypsy"},{key:"d",label:"m9",notes:["x",5,3,5,5,5],fingers:["x",2,1,3,4,4],tags:"jazz"},{key:"d",label:"m9",notes:["x",5,3,5,5,"x"],fingers:["x",2,1,3,4,"x"],tags:"jazz"},{key:"a",label:"m9",notes:[5,"x",5,5,5,7],fingers:[2,"x",3,3,3,4],tags:"jazz"},{key:"g",label:"m9",notes:["x","x",8,7,6,5],fingers:["x","x",4,3,2,1],bass:4,tags:"jazz"},{key:"d",label:"m9",notes:["x",8,7,5,5,"x"],fingers:["x",4,3,1,1,"x"],bass:4,tags:"jazz"},{key:"c",label:"m6/9",notes:[8,10,10,8,10,10],fingers:["T",2,2,1,3,3],tags:"gypsy"},{key:"c",label:"*7",notes:["x",3,4,2,4,"x"],fingers:["x",2,3,1,4,"x"],tags:"gypsy"},{key:"c",label:"*7",notes:[8,"x",7,8,7,"x"],fingers:[2,"x",1,3,1,"x"],tags:"gypsy"}]},banjo:{},mandolin:{},test:{eadgbe:[{key:"c",label:"M",notes:[3,3,5,5,5,"x"],fingers:[1,1,3,3,3,"x"],bass:7},{key:"c",label:"M",notes:[8,10,10,9,8,8],fingers:["T",3,4,2,1,1]},{key:"c",label:"M",notes:[12,"x",10,12,13,"x"],fingers:[2,"x",1,3,4,"x"],bass:4},{key:"c",label:"M6",notes:[3,3,5,5,5,5],fingers:[1,1,3,3,3,3],bass:7},{key:"c",label:"M6",notes:[8,8,10,10,9,10],fingers:["T","x",3,1,2,"x"]},{key:"c",label:"M6/9",notes:[8,10,10,9,10,10],fingers:["T",2,2,1,3,3]}]}},Voicings.getChordList=function(a,b){for(var c=Voicings.voicings[a.toLowerCase()][b.toLowerCase()],d=[],e=0;e<c.length;e++){var f=c[e].label;
-1===_.indexOf(d,f)&&d.push(f)}return d},Voicings.chordModelFromVoicing=function(a,b,c,d,e,f){void 0===e&&(e=0),void 0===f&&(f=!0);var g=new Aex.Flow.Music,h=Voicings._getChordVoicingData(a,b,c,e,f);if(!h)return null;d||(d=h.key),d=d.toLowerCase();var i=g.getNoteValue(d),j=g.getNoteValue(h.key),k=Voicings._bassNoteForKeyAndOffset(d,h.bass),l=d.toUpperCase()+h.label;""!==k&&(l+="/"+k.toUpperCase());for(var m=new Tuning(b),n=[],o=0;o<h.notes.length;o++){var p=o,q=h.notes[o],r={finger:h.fingers[o]};if(_.isNumber(q)){var s=g.getRelativeNoteValue(m.noteValForString(p),q,1);s===j&&(r.color="black")}var t=new GuitarNote(p,q,r);n.push(t)}var u=new ChordModel({notes:n,tuning:b,key:d,label:l}),v=g.getIntervalBetween(j,i,-1),w=g.getIntervalBetween(j,i,1),x=u.getMinFret();return x-v>=0?u.transposeByInterval(v,-1):u.transposeByInterval(w,1),u},Voicings.getNumVariations=function(a,b,c,d){void 0===d&&(d=!0);for(var e=Voicings.voicings[a.toLowerCase()][b.toLowerCase()],f=0,g=0;g<e.length;g++){var h=e[g];d||-1===h.label.indexOf(c)?d&&h.label===c&&f++:f++}return f},Voicings._getChordVoicingData=function(a,b,c,d,e){void 0===d&&(d=0),void 0===e&&(e=!0);for(var f=Voicings.voicings[a.toLowerCase()][b.toLowerCase()],g=0,h=0;h<f.length;h++){var i=f[h];if(e||-1===i.label.indexOf(c)){if(e&&i.label===c){if(g===d)return i;g++}}else{if(g===d)return i;g++}}return null},Voicings._bassNoteForKeyAndOffset=function(a,b){if(!b)return"";var c=new Aex.Flow.Music,d=c.getNoteValue(a.toLowerCase()),e=c.getRelativeNoteValue(d,b,1),f=c.getCanonicalNoteName(e);return f},Aex.Flow={},Aex.Flow.Music=function(){},Aex.Flow.Music.NUM_TONES=12,Aex.Flow.Music.roots=["c","d","e","f","g","a","b"],Aex.Flow.Music.root_values=[0,2,4,5,7,9,11],Aex.Flow.Music.root_indices={c:0,d:1,e:2,f:3,g:4,a:5,b:6},Aex.Flow.Music.accidentals=["bb","b","n","#","##"],Aex.Flow.Music.canonical_notes=["c","c#","d","d#","e","f","f#","g","g#","a","a#","b"],Aex.Flow.Music.noteValues={c:{root_index:0,int_val:0},cn:{root_index:0,int_val:0},"c#":{root_index:0,int_val:1},"c##":{root_index:0,int_val:2},cb:{root_index:0,int_val:11},cbb:{root_index:0,int_val:10},d:{root_index:1,int_val:2},dn:{root_index:1,int_val:2},"d#":{root_index:1,int_val:3},"d##":{root_index:1,int_val:4},db:{root_index:1,int_val:1},dbb:{root_index:1,int_val:0},e:{root_index:2,int_val:4},en:{root_index:2,int_val:4},"e#":{root_index:2,int_val:5},"e##":{root_index:2,int_val:6},eb:{root_index:2,int_val:3},ebb:{root_index:2,int_val:2},f:{root_index:3,int_val:5},fn:{root_index:3,int_val:5},"f#":{root_index:3,int_val:6},"f##":{root_index:3,int_val:7},fb:{root_index:3,int_val:4},fbb:{root_index:3,int_val:3},g:{root_index:4,int_val:7},gn:{root_index:4,int_val:7},"g#":{root_index:4,int_val:8},"g##":{root_index:4,int_val:9},gb:{root_index:4,int_val:6},gbb:{root_index:4,int_val:5},a:{root_index:5,int_val:9},an:{root_index:5,int_val:9},"a#":{root_index:5,int_val:10},"a##":{root_index:5,int_val:11},ab:{root_index:5,int_val:8},abb:{root_index:5,int_val:7},b:{root_index:6,int_val:11},bn:{root_index:6,int_val:11},"b#":{root_index:6,int_val:0},"b##":{root_index:6,int_val:1},bb:{root_index:6,int_val:10},bbb:{root_index:6,int_val:9}},Aex.Flow.Music.diatonic_intervals=["unison","m2","M2","m3","M3","p4","dim5","p5","m6","M6","b7","M7","octave"],Aex.Flow.Music.diatonic_accidentals={unison:{note:0,accidental:0},m2:{note:1,accidental:-1},M2:{note:1,accidental:0},m3:{note:2,accidental:-1},M3:{note:2,accidental:0},p4:{note:3,accidental:0},dim5:{note:4,accidental:-1},p5:{note:4,accidental:0},m6:{note:5,accidental:-1},M6:{note:5,accidental:0},b7:{note:6,accidental:-1},M7:{note:6,accidental:0},octave:{note:7,accidental:0}},Aex.Flow.Music.intervals={u:0,unison:0,m2:1,b2:1,min2:1,S:1,H:1,2:2,M2:2,maj2:2,T:2,W:2,m3:3,b3:3,min3:3,M3:4,3:4,maj3:4,4:5,p4:5,"#4":6,b5:6,aug4:6,dim5:6,5:7,p5:7,"#5":8,b6:8,aug5:8,6:9,M6:9,maj6:9,b7:10,m7:10,min7:10,dom7:10,M7:11,maj7:11,8:12,octave:12},Aex.Flow.Music.scales={major:[2,2,1,2,2,2,1],dorian:[2,1,2,2,2,1,2],phrygian:[1,2,2,2,1,2,2],lydian:[2,2,2,1,2,2,1],mixolydian:[2,2,1,2,2,1,2],minor:[2,1,2,2,1,2,2],locrian:[1,2,2,1,2,2,2],minpent:[3,2,2,3,2],majpent:[2,2,3,2,3],blues:[3,2,1,1,3,2],harmonicminor:[2,1,2,2,1,3,1],wholetone:[2,2,2,2,2,2]},Aex.Flow.Music.arpeggios={maj:[4,3,5],maj7:[4,3,4,1],maj6:[4,3,2,3],maj9:[2,2,3,4,1],min:[3,4,5],minmaj7:[3,4,4,1],m7:[3,4,3,2],m6:[3,4,2,3],m69:[2,1,4,2,3],m7b5:[3,3,4,2],7:[4,3,3,2],9:[2,2,3,3,2],13:[4,3,2,1,2],"13(9)":[2,2,3,2,1,2],"7b9":[1,3,3,3,2],"13b9":[],b13b9:[],dim:[3,3,3,3]},Aex.Flow.Music.prototype.isValidNoteValue=function(a){return null==a||0>a||a>=Aex.Flow.Music.NUM_TONES?!1:!0},Aex.Flow.Music.prototype.isValidIntervalValue=function(a){return this.isValidNoteValue(a)},Aex.Flow.Music.prototype.getNoteParts=function(a){if(!a||a.length<1)throw new Aex.RERR("BadArguments","Invalid note name: "+a);if(a.length>3)throw new Aex.RERR("BadArguments","Invalid note name: "+a);var b=a.toLowerCase(),c=/^([cdefgab])(b|bb|n|#|##)?$/,d=c.exec(b);if(null!=d){var e=d[1],f=d[2];return{root:e,accidental:f}}throw new Aex.RERR("BadArguments","Invalid note name: "+a)},Aex.Flow.Music.prototype.getKeyParts=function(a){if(!a||a.length<1)throw new Aex.RERR("BadArguments","Invalid key: "+a);var b=a.toLowerCase(),c=/^([cdefgab])(b|#)?(mel|harm|m|M)?$/,d=c.exec(b);if(null!=d){var e=d[1],f=d[2],g=d[3];return g||(g="M"),{root:e,accidental:f,type:g}}throw new Aex.RERR("BadArguments","Invalid key: "+a)},Aex.Flow.Music.prototype.getNoteValue=function(a){var b=Aex.Flow.Music.noteValues[a.toLowerCase()];if(null==b)throw new Aex.RERR("BadArguments","Invalid note name: "+a);return b.int_val},Aex.Flow.Music.prototype.getIntervalValue=function(a){var b=Aex.Flow.Music.intervals[a];if(null==b)throw new Aex.RERR("BadArguments","Invalid interval name: "+a);return b},Aex.Flow.Music.prototype.getCanonicalNoteName=function(a){if(!this.isValidNoteValue(a))throw new Aex.RERR("BadArguments","Invalid note value: "+a);return Aex.Flow.Music.canonical_notes[a]},Aex.Flow.Music.prototype.getCanonicalIntervalName=function(a){if(!this.isValidIntervalValue(a))throw new Aex.RERR("BadArguments","Invalid interval value: "+a);return Aex.Flow.Music.diatonic_intervals[a]},Aex.Flow.Music.prototype.getRelativeNoteValue=function(a,b,c){if(null==c&&(c=1),1!=c&&-1!=c)throw new Aex.RERR("BadArguments","Invalid direction: "+c);var d=(a+c*b)%Aex.Flow.Music.NUM_TONES;return 0>d&&(d+=Aex.Flow.Music.NUM_TONES),d},Aex.Flow.Music.prototype.getScaleTones=function(a,b){var c=[];c.push(a);for(var d=a,e=0;e<b.length;++e)d=this.getRelativeNoteValue(d,b[e]),d!=a&&c.push(d);return c},Aex.Flow.Music.prototype.getIntervalBetween=function(a,b,c){if(null==c&&(c=1),1!=c&&-1!=c)throw new Aex.RERR("BadArguments","Invalid direction: "+c);if(!this.isValidNoteValue(a)||!this.isValidNoteValue(b))throw new Aex.RERR("BadArguments","Invalid notes: "+a+", "+b);var d;return d=1==c?b-a:a-b,0>d&&(d+=Aex.Flow.Music.NUM_TONES),d},function(){function a(b,c,d){if(b===c)return 0!==b||1/b==1/c;if(null==b||null==c)return b===c;if(b._chain&&(b=b._wrapped),c._chain&&(c=c._wrapped),b.isEqual&&v.isFunction(b.isEqual))return b.isEqual(c);if(c.isEqual&&v.isFunction(c.isEqual))return c.isEqual(b);var e=i.call(b);if(e!=i.call(c))return!1;switch(e){case"[object String]":return b==""+c;case"[object Number]":return b!=+b?c!=+c:0==b?1/b==1/c:b==+c;case"[object Date]":case"[object Boolean]":return+b==+c;case"[object RegExp]":return b.source==c.source&&b.global==c.global&&b.multiline==c.multiline&&b.ignoreCase==c.ignoreCase}if("object"!=typeof b||"object"!=typeof c)return!1;for(var f=d.length;f--;)if(d[f]==b)return!0;d.push(b);var f=0,g=!0;if("[object Array]"==e){if(f=b.length,g=f==c.length)for(;f--&&(g=f in b==f in c&&a(b[f],c[f],d)););}else{if("constructor"in b!="constructor"in c||b.constructor!=c.constructor)return!1;for(var h in b)if(v.has(b,h)&&(f++,!(g=v.has(c,h)&&a(b[h],c[h],d))))break;if(g){for(h in c)if(v.has(c,h)&&!f--)break;g=!f}}return d.pop(),g}var b=this,c=b._,d={},e=Array.prototype,f=Object.prototype,g=e.slice,h=e.unshift,i=f.toString,j=f.hasOwnProperty,k=e.forEach,l=e.map,m=e.reduce,n=e.reduceRight,o=e.filter,p=e.every,q=e.some,r=e.indexOf,s=e.lastIndexOf,f=Array.isArray,t=Object.keys,u=Function.prototype.bind,v=function(a){return new G(a)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=v),exports._=v):b._=v,v.VERSION="1.3.3";var w=v.each=v.forEach=function(a,b,c){if(null!=a)if(k&&a.forEach===k)a.forEach(b,c);else if(a.length===+a.length)for(var e=0,f=a.length;f>e&&!(e in a&&b.call(c,a[e],e,a)===d);e++);else for(e in a)if(v.has(a,e)&&b.call(c,a[e],e,a)===d)break};v.map=v.collect=function(a,b,c){var d=[];return null==a?d:l&&a.map===l?a.map(b,c):(w(a,function(a,e,f){d[d.length]=b.call(c,a,e,f)}),a.length===+a.length&&(d.length=a.length),d)},v.reduce=v.foldl=v.inject=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),m&&a.reduce===m)return d&&(b=v.bind(b,d)),e?a.reduce(b,c):a.reduce(b);if(w(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)}),!e)throw new TypeError("Reduce of empty array with no initial value");return c},v.reduceRight=v.foldr=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),n&&a.reduceRight===n)return d&&(b=v.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=v.toArray(a).reverse();return d&&!e&&(b=v.bind(b,d)),e?v.reduce(f,b,c,d):v.reduce(f,b)},v.find=v.detect=function(a,b,c){var d;return x(a,function(a,e,f){return b.call(c,a,e,f)?(d=a,!0):void 0}),d},v.filter=v.select=function(a,b,c){var d=[];return null==a?d:o&&a.filter===o?a.filter(b,c):(w(a,function(a,e,f){b.call(c,a,e,f)&&(d[d.length]=a)}),d)},v.reject=function(a,b,c){var d=[];return null==a?d:(w(a,function(a,e,f){b.call(c,a,e,f)||(d[d.length]=a)}),d)},v.every=v.all=function(a,b,c){var e=!0;return null==a?e:p&&a.every===p?a.every(b,c):(w(a,function(a,f,g){return(e=e&&b.call(c,a,f,g))?void 0:d}),!!e)};var x=v.some=v.any=function(a,b,c){b||(b=v.identity);var e=!1;return null==a?e:q&&a.some===q?a.some(b,c):(w(a,function(a,f,g){return e||(e=b.call(c,a,f,g))?d:void 0}),!!e)};v.include=v.contains=function(a,b){var c=!1;return null==a?c:r&&a.indexOf===r?-1!=a.indexOf(b):c=x(a,function(a){return a===b})},v.invoke=function(a,b){var c=g.call(arguments,2);return v.map(a,function(a){return(v.isFunction(b)?b||a:a[b]).apply(a,c)})},v.pluck=function(a,b){return v.map(a,function(a){return a[b]})},v.max=function(a,b,c){if(!b&&v.isArray(a)&&a[0]===+a[0])return Math.max.apply(Math,a);if(!b&&v.isEmpty(a))return-1/0;var d={computed:-1/0};return w(a,function(a,e,f){e=b?b.call(c,a,e,f):a,e>=d.computed&&(d={value:a,computed:e})}),d.value},v.min=function(a,b,c){if(!b&&v.isArray(a)&&a[0]===+a[0])return Math.min.apply(Math,a);if(!b&&v.isEmpty(a))return 1/0;var d={computed:1/0};return w(a,function(a,e,f){e=b?b.call(c,a,e,f):a,e<d.computed&&(d={value:a,computed:e})}),d.value},v.shuffle=function(a){var b,c=[];return w(a,function(a,d){b=Math.floor(Math.random()*(d+1)),c[d]=c[b],c[b]=a}),c},v.sortBy=function(a,b,c){var d=v.isFunction(b)?b:function(a){return a[b]};return v.pluck(v.map(a,function(a,b,e){return{value:a,criteria:d.call(c,a,b,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;return void 0===c?1:void 0===d?-1:d>c?-1:c>d?1:0}),"value")},v.groupBy=function(a,b){var c={},d=v.isFunction(b)?b:function(a){return a[b]};return w(a,function(a,b){var e=d(a,b);(c[e]||(c[e]=[])).push(a)}),c},v.sortedIndex=function(a,b,c){c||(c=v.identity);for(var d=0,e=a.length;e>d;){var f=d+e>>1;c(a[f])<c(b)?d=f+1:e=f}return d},v.toArray=function(a){return a?v.isArray(a)||v.isArguments(a)?g.call(a):a.toArray&&v.isFunction(a.toArray)?a.toArray():v.values(a):[]},v.size=function(a){return v.isArray(a)?a.length:v.keys(a).length},v.first=v.head=v.take=function(a,b,c){return null==b||c?a[0]:g.call(a,0,b)},v.initial=function(a,b,c){return g.call(a,0,a.length-(null==b||c?1:b))},v.last=function(a,b,c){return null==b||c?a[a.length-1]:g.call(a,Math.max(a.length-b,0))},v.rest=v.tail=function(a,b,c){return g.call(a,null==b||c?1:b)},v.compact=function(a){return v.filter(a,function(a){return!!a})},v.flatten=function(a,b){return v.reduce(a,function(a,c){return v.isArray(c)?a.concat(b?c:v.flatten(c)):(a[a.length]=c,a)},[])},v.without=function(a){return v.difference(a,g.call(arguments,1))},v.uniq=v.unique=function(a,b,c){var c=c?v.map(a,c):a,d=[];return a.length<3&&(b=!0),v.reduce(c,function(c,e,f){return(b?v.last(c)===e&&c.length:v.include(c,e))||(c.push(e),d.push(a[f])),c},[]),d},v.union=function(){return v.uniq(v.flatten(arguments,!0))},v.intersection=v.intersect=function(a){var b=g.call(arguments,1);return v.filter(v.uniq(a),function(a){return v.every(b,function(b){return v.indexOf(b,a)>=0})})},v.difference=function(a){var b=v.flatten(g.call(arguments,1),!0);return v.filter(a,function(a){return!v.include(b,a)})},v.zip=function(){for(var a=g.call(arguments),b=v.max(v.pluck(a,"length")),c=Array(b),d=0;b>d;d++)c[d]=v.pluck(a,""+d);return c},v.indexOf=function(a,b,c){if(null==a)return-1;var d;if(c)return c=v.sortedIndex(a,b),a[c]===b?c:-1;if(r&&a.indexOf===r)return a.indexOf(b);for(c=0,d=a.length;d>c;c++)if(c in a&&a[c]===b)return c;return-1},v.lastIndexOf=function(a,b){if(null==a)return-1;if(s&&a.lastIndexOf===s)return a.lastIndexOf(b);for(var c=a.length;c--;)if(c in a&&a[c]===b)return c;return-1},v.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0);for(var c=arguments[2]||1,d=Math.max(Math.ceil((b-a)/c),0),e=0,f=Array(d);d>e;)f[e++]=a,a+=c;return f};var y=function(){};v.bind=function(a,b){var c,d;if(a.bind===u&&u)return u.apply(a,g.call(arguments,1));if(!v.isFunction(a))throw new TypeError;return d=g.call(arguments,2),c=function(){if(!(this instanceof c))return a.apply(b,d.concat(g.call(arguments)));y.prototype=a.prototype;var e=new y,f=a.apply(e,d.concat(g.call(arguments)));return Object(f)===f?f:e}},v.bindAll=function(a){var b=g.call(arguments,1);return 0==b.length&&(b=v.functions(a)),w(b,function(b){a[b]=v.bind(a[b],a)}),a},v.memoize=function(a,b){var c={};return b||(b=v.identity),function(){var d=b.apply(this,arguments);return v.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}},v.delay=function(a,b){var c=g.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},v.defer=function(a){return v.delay.apply(v,[a,1].concat(g.call(arguments,1)))},v.throttle=function(a,b){var c,d,e,f,g,h,i=v.debounce(function(){g=f=!1},b);return function(){return c=this,d=arguments,e||(e=setTimeout(function(){e=null,g&&a.apply(c,d),i()},b)),f?g=!0:h=a.apply(c,d),i(),f=!0,h}},v.debounce=function(a,b,c){var d;return function(){var e=this,f=arguments;c&&!d&&a.apply(e,f),clearTimeout(d),d=setTimeout(function(){d=null,c||a.apply(e,f)},b)}},v.once=function(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,arguments))}},v.wrap=function(a,b){return function(){var c=[a].concat(g.call(arguments,0));return b.apply(this,c)}},v.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},v.after=function(a,b){return 0>=a?b():function(){return--a<1?b.apply(this,arguments):void 0}},v.keys=t||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b,c=[];for(b in a)v.has(a,b)&&(c[c.length]=b);return c},v.values=function(a){return v.map(a,v.identity)},v.functions=v.methods=function(a){var b,c=[];for(b in a)v.isFunction(a[b])&&c.push(b);return c.sort()},v.extend=function(a){return w(g.call(arguments,1),function(b){for(var c in b)a[c]=b[c]}),a},v.pick=function(a){var b={};return w(v.flatten(g.call(arguments,1)),function(c){c in a&&(b[c]=a[c])}),b},v.defaults=function(a){return w(g.call(arguments,1),function(b){for(var c in b)null==a[c]&&(a[c]=b[c])}),a},v.clone=function(a){return v.isObject(a)?v.isArray(a)?a.slice():v.extend({},a):a},v.tap=function(a,b){return b(a),a},v.isEqual=function(b,c){return a(b,c,[])},v.isEmpty=function(a){if(null==a)return!0;if(v.isArray(a)||v.isString(a))return 0===a.length;for(var b in a)if(v.has(a,b))return!1;return!0},v.isElement=function(a){return!(!a||1!=a.nodeType)},v.isArray=f||function(a){return"[object Array]"==i.call(a)},v.isObject=function(a){return a===Object(a)},v.isArguments=function(a){return"[object Arguments]"==i.call(a)},v.isArguments(arguments)||(v.isArguments=function(a){return!(!a||!v.has(a,"callee"))}),v.isFunction=function(a){return"[object Function]"==i.call(a)},v.isString=function(a){return"[object String]"==i.call(a)},v.isNumber=function(a){return"[object Number]"==i.call(a)},v.isFinite=function(a){return v.isNumber(a)&&isFinite(a)},v.isNaN=function(a){return a!==a},v.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"==i.call(a)},v.isDate=function(a){return"[object Date]"==i.call(a)},v.isRegExp=function(a){return"[object RegExp]"==i.call(a)},v.isNull=function(a){return null===a},v.isUndefined=function(a){return void 0===a},v.has=function(a,b){return j.call(a,b)},v.noConflict=function(){return b._=c,this},v.identity=function(a){return a},v.times=function(a,b,c){for(var d=0;a>d;d++)b.call(c,d)},v.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},v.result=function(a,b){if(null==a)return null;var c=a[b];return v.isFunction(c)?c.call(a):c},v.mixin=function(a){w(v.functions(a),function(b){I(b,v[b]=a[b])})};var z=0;v.uniqueId=function(a){var b=z++;return a?a+b:b},v.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var A,B=/.^/,C={"\\":"\\","'":"'",r:"\r",n:"\n",t:"	",u2028:"\u2028",u2029:"\u2029"};for(A in C)C[C[A]]=A;var D=/\\|'|\r|\n|\t|\u2028|\u2029/g,E=/\\(\\|'|r|n|t|u2028|u2029)/g,F=function(a){return a.replace(E,function(a,b){return C[b]})};v.template=function(a,b,c){c=v.defaults(c||{},v.templateSettings),a="__p+='"+a.replace(D,function(a){return"\\"+C[a]}).replace(c.escape||B,function(a,b){return"'+\n_.escape("+F(b)+")+\n'"}).replace(c.interpolate||B,function(a,b){return"'+\n("+F(b)+")+\n'"}).replace(c.evaluate||B,function(a,b){return"';\n"+F(b)+"\n;__p+='"})+"';\n",c.variable||(a="with(obj||{}){\n"+a+"}\n");var a="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+a+"return __p;\n",d=new Function(c.variable||"obj","_",a);return b?d(b,v):(b=function(a){return d.call(this,a,v)},b.source="function("+(c.variable||"obj")+"){\n"+a+"}",b)},v.chain=function(a){return v(a).chain()};var G=function(a){this._wrapped=a};v.prototype=G.prototype;var H=function(a,b){return b?v(a).chain():a},I=function(a,b){G.prototype[a]=function(){var a=g.call(arguments);return h.call(a,this._wrapped),H(b.apply(v,a),this._chain)}};v.mixin(v),w("pop,push,reverse,shift,sort,splice,unshift".split(","),function(a){var b=e[a];G.prototype[a]=function(){var c=this._wrapped;b.apply(c,arguments);var d=c.length;return("shift"==a||"splice"==a)&&0===d&&delete c[0],H(c,this._chain)}}),w(["concat","join","slice"],function(a){var b=e[a];G.prototype[a]=function(){return H(b.apply(this._wrapped,arguments),this._chain)}}),G.prototype.chain=function(){return this._chain=!0,this},G.prototype.value=function(){return this._wrapped}}.call(this),ChordParserPEG=function(){function a(a){return'"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E-\x1F\x80-\uFFFF]/g,escape)+'"'}var b={parse:function(b,c){function d(a){V>T||(T>V&&(V=T,W=[]),W.push(a))}function e(){var a,b,c,d,e,g,h,j;return h=T,j=T,a=M(),null!==a?(b=f(),b=null!==b?b:"",null!==b?(c=M(),null!==c?(d=i(),null!==d?(e=M(),null!==e?(g=L(),null!==g?a=[a,b,c,d,e,g]:(a=null,T=j)):(a=null,T=j)):(a=null,T=j)):(a=null,T=j)):(a=null,T=j)):(a=null,T=j),null!==a&&(a=function(a,b,c){return{config:b?b:{},strings:c}}(h,a[1],a[3])),null===a&&(T=h),a}function f(){var a,c,e,f,h,i;return h=T,i=T,a=L(),null!==a?(91===b.charCodeAt(T)?(c="[",T++):(c=null,0===U&&d('"["')),null!==c?(e=g(),null!==e?(93===b.charCodeAt(T)?(f="]",T++):(f=null,0===U&&d('"]"')),null!==f?a=[a,c,e,f]:(a=null,T=i)):(a=null,T=i)):(a=null,T=i)):(a=null,T=i),null!==a&&(a=function(a,b){return b}(h,a[2])),null===a&&(T=h),a}function g(){var a,c,e,f,g,i,j,k;if(i=T,j=T,a=h(),null!==a){for(c=[],k=T,e=L(),null!==e?(44===b.charCodeAt(T)?(f=",",T++):(f=null,0===U&&d('","')),null!==f?(g=h(),null!==g?e=[e,f,g]:(e=null,T=k)):(e=null,T=k)):(e=null,T=k);null!==e;)c.push(e),k=T,e=L(),null!==e?(44===b.charCodeAt(T)?(f=",",T++):(f=null,0===U&&d('","')),null!==f?(g=h(),null!==g?e=[e,f,g]:(e=null,T=k)):(e=null,T=k)):(e=null,T=k);null!==c?a=[a,c]:(a=null,T=j)}else a=null,T=j;return null!==a&&(a=function(a,b,c){var d={};d[b.key]=b.value;for(var e=0;e<c.length;e++){var f=c[e][2];d[f.key]=f.value}return d}(i,a[0],a[1])),null===a&&(T=i),a}function h(){var a,c,e,f,g,h,i,j,k;return j=T,k=T,a=L(),null!==a?(c=w(),null!==c?(e=L(),null!==e?(61===b.charCodeAt(T)?(f="=",T++):(f=null,0===U&&d('"="')),null!==f?(g=L(),null!==g?(h=p(),null!==h?(i=L(),null!==i?a=[a,c,e,f,g,h,i]:(a=null,T=k)):(a=null,T=k)):(a=null,T=k)):(a=null,T=k)):(a=null,T=k)):(a=null,T=k)):(a=null,T=k),null!==a&&(a=function(a,b,c){return{key:b,value:c}}(j,a[1],a[5])),null===a&&(T=j),a}function i(){var a,b,c,d,e,f,g,h,i,k;if(g=T,h=T,a=M(),null!==a)if(b=j(),null!==b){if(c=[],i=T,k=T,e=L(),null!==e?(f=P(),null!==f?e=[e,f]:(e=null,T=k)):(e=null,T=k),null!==e)for(d=[];null!==e;)d.push(e),k=T,e=L(),null!==e?(f=P(),null!==f?e=[e,f]:(e=null,T=k)):(e=null,T=k);else d=null;for(null!==d?(e=j(),null!==e?d=[d,e]:(d=null,T=i)):(d=null,T=i);null!==d;){if(c.push(d),i=T,k=T,e=L(),null!==e?(f=P(),null!==f?e=[e,f]:(e=null,T=k)):(e=null,T=k),null!==e)for(d=[];null!==e;)d.push(e),k=T,e=L(),null!==e?(f=P(),null!==f?e=[e,f]:(e=null,T=k)):(e=null,T=k);else d=null;null!==d?(e=j(),null!==e?d=[d,e]:(d=null,T=i)):(d=null,T=i)}null!==c?(d=M(),null!==d?a=[a,b,c,d]:(a=null,T=h)):(a=null,T=h)}else a=null,T=h;else a=null,T=h;return null!==a&&(a=function(a,b,c){var d={};d[b.string]={string:b.string,frets:b.frets};for(var e=0;e<c.length;e++){var f=c[e][1];if(d[f.string])for(var g=0;g<f.frets.length;g++)d[f.string].frets.push(f.frets[g]);else d[f.string]={string:f.string,frets:f.frets}}return d}(g,a[1],a[2])),null===a&&(T=g),a}function j(){var a,c,e,f,g,h,i,j,l;return j=T,l=T,a=L(),null!==a?(c=B(),null!==c?(e=L(),null!==e?(58===b.charCodeAt(T)?(f=":",T++):(f=null,0===U&&d('":"')),null!==f?(g=L(),null!==g?(h=k(),null!==h?(i=L(),null!==i?a=[a,c,e,f,g,h,i]:(a=null,T=l)):(a=null,T=l)):(a=null,T=l)):(a=null,T=l)):(a=null,T=l)):(a=null,T=l)):(a=null,T=l),null!==a&&(a=function(a,b,c){return{string:b,frets:c}}(j,a[1],a[5])),null===a&&(T=j),a}function k(){var a,c,e,f,g,h,i,j,k;if(i=T,j=T,a=l(),null!==a){for(c=[],k=T,e=L(),null!==e?(44===b.charCodeAt(T)?(f=",",T++):(f=null,0===U&&d('","')),null!==f?(g=L(),null!==g?(h=l(),null!==h?e=[e,f,g,h]:(e=null,T=k)):(e=null,T=k)):(e=null,T=k)):(e=null,T=k);null!==e;)c.push(e),k=T,e=L(),null!==e?(44===b.charCodeAt(T)?(f=",",T++):(f=null,0===U&&d('","')),null!==f?(g=L(),null!==g?(h=l(),null!==h?e=[e,f,g,h]:(e=null,T=k)):(e=null,T=k)):(e=null,T=k)):(e=null,T=k);null!==c?a=[a,c]:(a=null,T=j)}else a=null,T=j;return null!==a&&(a=function(a,b,c){for(var d=[b],e=0;e<c.length;e++)d.push(c[e][3]);return d}(i,a[0],a[1])),null===a&&(T=i),a}function l(){var a,c,e,f,g,h,i,j,k,l,n;return l=T,n=T,a=B(),null===a&&(/^[TtXxMm]/.test(b.charAt(T))?(a=b.charAt(T),T++):(a=null,0===U&&d("[TtXxMm]"))),null!==a?(c=L(),null!==c?(e=m(),e=null!==e?e:"",null!==e?a=[a,c,e]:(a=null,T=n)):(a=null,T=n)):(a=null,T=n),null!==a&&(a=function(a,b,c){return""!==c?{fret:b,config:""==c?{}:c}:{fret:b}}(l,a[0],a[2])),null===a&&(T=l),null===a&&(l=T,n=T,123===b.charCodeAt(T)?(a="{",T++):(a=null,0===U&&d('"{"')),null!==a?(c=L(),null!==c?(e=B(),null===e&&(/^[XxMm]/.test(b.charAt(T))?(e=b.charAt(T),T++):(e=null,0===U&&d("[XxMm]"))),null!==e?(f=L(),null!==f?(g=B(),null===g&&(/^[TtXxMm]/.test(b.charAt(T))?(g=b.charAt(T),T++):(g=null,0===U&&d("[TtXxMm]"))),null!==g?(h=L(),null!==h?(125===b.charCodeAt(T)?(i="}",T++):(i=null,0===U&&d('"}"')),null!==i?(j=L(),null!==j?(k=m(),k=null!==k?k:"",null!==k?a=[a,c,e,f,g,h,i,j,k]:(a=null,T=n)):(a=null,T=n)):(a=null,T=n)):(a=null,T=n)):(a=null,T=n)):(a=null,T=n)):(a=null,T=n)):(a=null,T=n)):(a=null,T=n),null!==a&&(a=function(a,b,c,d){return""!==d?{fret:b,finger:""+c,config:""==d?{}:d}:{fret:b,finger:""+c}}(l,a[2],a[4],a[8])),null===a&&(T=l)),a}function m(){var a,c,e,f,g,h,i;return h=T,i=T,40===b.charCodeAt(T)?(a="(",T++):(a=null,0===U&&d('"("')),null!==a?(c=L(),null!==c?(41===b.charCodeAt(T)?(e=")",T++):(e=null,0===U&&d('")"')),null!==e?a=[a,c,e]:(a=null,T=i)):(a=null,T=i)):(a=null,T=i),null!==a&&(a=function(){return{}}(h)),null===a&&(T=h),null===a&&(h=T,i=T,40===b.charCodeAt(T)?(a="(",T++):(a=null,0===U&&d('"("')),null!==a?(c=L(),null!==c?(e=n(),null!==e?(f=L(),null!==f?(41===b.charCodeAt(T)?(g=")",T++):(g=null,0===U&&d('")"')),null!==g?a=[a,c,e,f,g]:(a=null,T=i)):(a=null,T=i)):(a=null,T=i)):(a=null,T=i)):(a=null,T=i),null!==a&&(a=function(a,b){return b}(h,a[2])),null===a&&(T=h)),a}function n(){var a,c,e,f,g,h,i,j,k;if(i=T,j=T,a=o(),null!==a){for(c=[],k=T,e=L(),null!==e?(59===b.charCodeAt(T)?(f=";",T++):(f=null,0===U&&d('";"')),null!==f?(g=L(),null!==g?(h=o(),null!==h?e=[e,f,g,h]:(e=null,T=k)):(e=null,T=k)):(e=null,T=k)):(e=null,T=k);null!==e;)c.push(e),k=T,e=L(),null!==e?(59===b.charCodeAt(T)?(f=";",T++):(f=null,0===U&&d('";"')),null!==f?(g=L(),null!==g?(h=o(),null!==h?e=[e,f,g,h]:(e=null,T=k)):(e=null,T=k)):(e=null,T=k)):(e=null,T=k);null!==c?(59===b.charCodeAt(T)?(e=";",T++):(e=null,0===U&&d('";"')),e=null!==e?e:"",null!==e?a=[a,c,e]:(a=null,T=j)):(a=null,T=j)}else a=null,T=j;return null!==a&&(a=function(a,b,c){var d={};d[b.key]=b.value;for(var e=0;e<c.length;e++){var f=c[e][3];d[f.key]=f.value}return d}(i,a[0],a[1])),null===a&&(T=i),a}function o(){var a,c,e,f,g,h,i,j;return i=T,j=T,a=w(),null!==a?(c=L(),null!==c?(58===b.charCodeAt(T)?(e=":",T++):(e=null,0===U&&d('":"')),null!==e?(f=L(),null!==f?(g=p(),null===g&&(g=w()),null!==g?(h=L(),null!==h?a=[a,c,e,f,g,h]:(a=null,T=j)):(a=null,T=j)):(a=null,T=j)):(a=null,T=j)):(a=null,T=j)):(a=null,T=j),null!==a&&(a=function(a,b,c){return{key:b,value:c}}(i,a[0],a[4])),null===a&&(T=i),a}function p(){var a,c,e,f;return a=v(),null===a&&(a=C(),null===a&&(e=T,f=T,"true"===b.substr(T,4)?(a="true",T+=4):(a=null,0===U&&d('"true"')),null!==a?(c=L(),null!==c?a=[a,c]:(a=null,T=f)):(a=null,T=f),null!==a&&(a=function(){return!0}(e)),null===a&&(T=e),null===a&&(e=T,f=T,"false"===b.substr(T,5)?(a="false",T+=5):(a=null,0===U&&d('"false"')),null!==a?(c=L(),null!==c?a=[a,c]:(a=null,T=f)):(a=null,T=f),null!==a&&(a=function(){return!1}(e)),null===a&&(T=e)))),a}function q(){var a;return/^[0-9a-fA-F]/.test(b.charAt(T))?(a=b.charAt(T),T++):(a=null,0===U&&d("[0-9a-fA-F]")),a}function r(){var a,c,e,f,g,h,i,j,k,l;return j=T,k=T,92===b.charCodeAt(T)?(a="\\",T++):(a=null,0===U&&d('"\\\\"')),null!==a?(l=T,c=q(),null!==c?(e=q(),e=null!==e?e:"",null!==e?(f=q(),f=null!==f?f:"",null!==f?(g=q(),g=null!==g?g:"",null!==g?(h=q(),h=null!==h?h:"",null!==h?(i=q(),i=null!==i?i:"",null!==i?c=[c,e,f,g,h,i]:(c=null,T=l)):(c=null,T=l)):(c=null,T=l)):(c=null,T=l)):(c=null,T=l)):(c=null,T=l),null!==c?("\r\n"===b.substr(T,2)?(e="\r\n",T+=2):(e=null,0===U&&d('"\\r\\n"')),null===e&&(/^[ \t\r\n\f]/.test(b.charAt(T))?(e=b.charAt(T),T++):(e=null,0===U&&d("[ \\t\\r\\n\\f]"))),e=null!==e?e:"",null!==e?a=[a,c,e]:(a=null,T=k)):(a=null,T=k)):(a=null,T=k),null!==a&&(a=function(a,b){return String.fromCharCode(parseInt(b.join(""),16))}(j,a[1])),null===a&&(T=j),a}function s(){var a,c,e,f;return a=r(),null===a&&(e=T,f=T,92===b.charCodeAt(T)?(a="\\",T++):(a=null,0===U&&d('"\\\\"')),null!==a?(/^[^\r\n\f0-9a-fA-F]/.test(b.charAt(T))?(c=b.charAt(T),T++):(c=null,0===U&&d("[^\\r\\n\\f0-9a-fA-F]")),null!==c?a=[a,c]:(a=null,T=f)):(a=null,T=f),null!==a&&(a=function(a,b){return b}(e,a[1])),null===a&&(T=e)),a}function t(){var a,c,e,f,g,h,i,j;if(g=T,h=T,34===b.charCodeAt(T)?(a='"',T++):(a=null,0===U&&d('"\\""')),null!==a){for(c=[],/^[^\n\r\f\\"]/.test(b.charAt(T))?(e=b.charAt(T),T++):(e=null,0===U&&d('[^\\n\\r\\f\\\\"]')),null===e&&(i=T,j=T,92===b.charCodeAt(T)?(e="\\",T++):(e=null,0===U&&d('"\\\\"')),null!==e?(f=P(),null!==f?e=[e,f]:(e=null,T=j)):(e=null,T=j),null!==e&&(e=function(a,b){return b}(i,e[1])),null===e&&(T=i),null===e&&(e=s()));null!==e;)c.push(e),/^[^\n\r\f\\"]/.test(b.charAt(T))?(e=b.charAt(T),T++):(e=null,0===U&&d('[^\\n\\r\\f\\\\"]')),null===e&&(i=T,j=T,92===b.charCodeAt(T)?(e="\\",T++):(e=null,0===U&&d('"\\\\"')),null!==e?(f=P(),null!==f?e=[e,f]:(e=null,T=j)):(e=null,T=j),null!==e&&(e=function(a,b){return b}(i,e[1])),null===e&&(T=i),null===e&&(e=s()));null!==c?(34===b.charCodeAt(T)?(e='"',T++):(e=null,0===U&&d('"\\""')),null!==e?a=[a,c,e]:(a=null,T=h)):(a=null,T=h)}else a=null,T=h;return null!==a&&(a=function(a,b){return b.join("")}(g,a[1])),null===a&&(T=g),a}function u(){var a,c,e,f,g,h,i,j;if(g=T,h=T,39===b.charCodeAt(T)?(a="'",T++):(a=null,0===U&&d('"\'"')),null!==a){for(c=[],/^[^\n\r\f\\']/.test(b.charAt(T))?(e=b.charAt(T),T++):(e=null,0===U&&d("[^\\n\\r\\f\\\\']")),null===e&&(i=T,j=T,92===b.charCodeAt(T)?(e="\\",T++):(e=null,0===U&&d('"\\\\"')),null!==e?(f=P(),null!==f?e=[e,f]:(e=null,T=j)):(e=null,T=j),null!==e&&(e=function(a,b){return b}(i,e[1])),null===e&&(T=i),null===e&&(e=s()));null!==e;)c.push(e),/^[^\n\r\f\\']/.test(b.charAt(T))?(e=b.charAt(T),T++):(e=null,0===U&&d("[^\\n\\r\\f\\\\']")),null===e&&(i=T,j=T,92===b.charCodeAt(T)?(e="\\",T++):(e=null,0===U&&d('"\\\\"')),null!==e?(f=P(),null!==f?e=[e,f]:(e=null,T=j)):(e=null,T=j),null!==e&&(e=function(a,b){return b}(i,e[1])),null===e&&(T=i),null===e&&(e=s()));null!==c?(39===b.charCodeAt(T)?(e="'",T++):(e=null,0===U&&d('"\'"')),null!==e?a=[a,c,e]:(a=null,T=h)):(a=null,T=h)}else a=null,T=h;return null!==a&&(a=function(a,b){return b.join("")}(g,a[1])),null===a&&(T=g),a}function v(){var a;return U++,a=t(),null===a&&(a=u()),U--,0===U&&null===a&&d("string"),a}function w(){var a,c,e,f,g,h;if(g=T,h=T,45===b.charCodeAt(T)?(a="-",T++):(a=null,0===U&&d('"-"')),a=null!==a?a:"",null!==a)if(c=x(),null!==c){for(e=[],f=y();null!==f;)e.push(f),f=y();null!==e?a=[a,c,e]:(a=null,T=h)}else a=null,T=h;else a=null,T=h;return null!==a&&(a=function(a,b,c,d){return(null!==b?b:"")+c+d.join("")}(g,a[0],a[1],a[2])),null===a&&(T=g),a}function x(){var a;return/^[_a-zA-Z]/.test(b.charAt(T))?(a=b.charAt(T),T++):(a=null,0===U&&d("[_a-zA-Z]")),a}function y(){var a;return/^[_a-zA-Z0-9\-]/.test(b.charAt(T))?(a=b.charAt(T),T++):(a=null,0===U&&d("[_a-zA-Z0-9\\-]")),a}function z(){var a,b,c;if(c=T,b=A(),null!==b)for(a=[];null!==b;)a.push(b),b=A();else a=null;return null!==a&&(a=function(a,b){return b.join("")}(c,a)),null===a&&(T=c),a}function A(){var a,c,e,f,g,h,i,j;return/^[^"\\\0-\x1F]/.test(b.charAt(T))?(a=b.charAt(T),T++):(a=null,0===U&&d('[^"\\\\\\0-\\x1F]')),null===a&&(h=T,'\\"'===b.substr(T,2)?(a='\\"',T+=2):(a=null,0===U&&d('"\\\\\\""')),null!==a&&(a=function(){return'"'}(h)),null===a&&(T=h),null===a&&(h=T,"\\\\"===b.substr(T,2)?(a="\\\\",T+=2):(a=null,0===U&&d('"\\\\\\\\"')),null!==a&&(a=function(){return"\\"}(h)),null===a&&(T=h),null===a&&(h=T,"\\/"===b.substr(T,2)?(a="\\/",T+=2):(a=null,0===U&&d('"\\\\/"')),null!==a&&(a=function(){return"/"}(h)),null===a&&(T=h),null===a&&(h=T,"\\b"===b.substr(T,2)?(a="\\b",T+=2):(a=null,0===U&&d('"\\\\b"')),null!==a&&(a=function(){return"\b"}(h)),null===a&&(T=h),null===a&&(h=T,"\\f"===b.substr(T,2)?(a="\\f",T+=2):(a=null,0===U&&d('"\\\\f"')),null!==a&&(a=function(){return"\f"}(h)),null===a&&(T=h),null===a&&(h=T,"\\n"===b.substr(T,2)?(a="\\n",T+=2):(a=null,0===U&&d('"\\\\n"')),null!==a&&(a=function(){return"\n"}(h)),null===a&&(T=h),null===a&&(h=T,"\\r"===b.substr(T,2)?(a="\\r",T+=2):(a=null,0===U&&d('"\\\\r"')),null!==a&&(a=function(){return"\r"}(h)),null===a&&(T=h),null===a&&(h=T,"\\t"===b.substr(T,2)?(a="\\t",T+=2):(a=null,0===U&&d('"\\\\t"')),null!==a&&(a=function(){return"	"}(h)),null===a&&(T=h),null===a&&(h=T,i=T,"\\u"===b.substr(T,2)?(a="\\u",T+=2):(a=null,0===U&&d('"\\\\u"')),null!==a?(j=T,c=K(),null!==c?(e=K(),null!==e?(f=K(),null!==f?(g=K(),null!==g?c=[c,e,f,g]:(c=null,T=j)):(c=null,T=j)):(c=null,T=j)):(c=null,T=j),null!==c?a=[a,c]:(a=null,T=i)):(a=null,T=i),null!==a&&(a=function(a,b){return String.fromCharCode(parseInt("0x"+b.join("")))
}(h,a[1])),null===a&&(T=h)))))))))),a}function B(){var a,b,c,e;return U++,c=T,e=T,a=D(),null!==a?(b=L(),null!==b?a=[a,b]:(a=null,T=e)):(a=null,T=e),null!==a&&(a=function(a,b){return parseFloat(b)}(c,a[0])),null===a&&(T=c),U--,0===U&&null===a&&d("integer"),a}function C(){var a,b,c,e,f,g;return U++,e=T,f=T,g=T,a=D(),null!==a?(b=E(),null!==b?(c=F(),null!==c?a=[a,b,c]:(a=null,T=g)):(a=null,T=g)):(a=null,T=g),null!==a?(b=L(),null!==b?a=[a,b]:(a=null,T=f)):(a=null,T=f),null!==a&&(a=function(a,b){return parseFloat(b.join(""))}(e,a[0])),null===a&&(T=e),null===a&&(e=T,f=T,g=T,a=D(),null!==a?(b=E(),null!==b?a=[a,b]:(a=null,T=g)):(a=null,T=g),null!==a?(b=L(),null!==b?a=[a,b]:(a=null,T=f)):(a=null,T=f),null!==a&&(a=function(a,b){return parseFloat(b.join(""))}(e,a[0])),null===a&&(T=e),null===a&&(e=T,f=T,g=T,a=D(),null!==a?(b=F(),null!==b?a=[a,b]:(a=null,T=g)):(a=null,T=g),null!==a?(b=L(),null!==b?a=[a,b]:(a=null,T=f)):(a=null,T=f),null!==a&&(a=function(a,b){return parseFloat(b.join(""))}(e,a[0])),null===a&&(T=e),null===a&&(e=T,f=T,a=D(),null!==a?(b=L(),null!==b?a=[a,b]:(a=null,T=f)):(a=null,T=f),null!==a&&(a=function(a,b){return parseFloat(b)}(e,a[0])),null===a&&(T=e)))),U--,0===U&&null===a&&d("number"),a}function D(){var a,c,e,f,g;return f=T,g=T,a=J(),null!==a?(c=G(),null!==c?a=[a,c]:(a=null,T=g)):(a=null,T=g),null!==a&&(a=function(a,b,c){return b+c}(f,a[0],a[1])),null===a&&(T=f),null===a&&(a=I(),null===a&&(f=T,g=T,45===b.charCodeAt(T)?(a="-",T++):(a=null,0===U&&d('"-"')),null!==a?(c=J(),null!==c?(e=G(),null!==e?a=[a,c,e]:(a=null,T=g)):(a=null,T=g)):(a=null,T=g),null!==a&&(a=function(a,b,c){return"-"+b+c}(f,a[1],a[2])),null===a&&(T=f),null===a&&(f=T,g=T,45===b.charCodeAt(T)?(a="-",T++):(a=null,0===U&&d('"-"')),null!==a?(c=I(),null!==c?a=[a,c]:(a=null,T=g)):(a=null,T=g),null!==a&&(a=function(a,b){return"-"+b}(f,a[1])),null===a&&(T=f)))),a}function E(){var a,c,e,f;return e=T,f=T,46===b.charCodeAt(T)?(a=".",T++):(a=null,0===U&&d('"."')),null!==a?(c=G(),null!==c?a=[a,c]:(a=null,T=f)):(a=null,T=f),null!==a&&(a=function(a,b){return"."+b}(e,a[1])),null===a&&(T=e),a}function F(){var a,b,c,d;return c=T,d=T,a=H(),null!==a?(b=G(),null!==b?a=[a,b]:(a=null,T=d)):(a=null,T=d),null!==a&&(a=function(a,b){return"e"+b}(c,a[1])),null===a&&(T=c),a}function G(){var a,b,c;if(c=T,b=I(),null!==b)for(a=[];null!==b;)a.push(b),b=I();else a=null;return null!==a&&(a=function(a,b){return b.join("")}(c,a)),null===a&&(T=c),a}function H(){var a,c,e,f;return e=T,f=T,/^[eE]/.test(b.charAt(T))?(a=b.charAt(T),T++):(a=null,0===U&&d("[eE]")),null!==a?(/^[+\-]/.test(b.charAt(T))?(c=b.charAt(T),T++):(c=null,0===U&&d("[+\\-]")),c=null!==c?c:"",null!==c?a=[a,c]:(a=null,T=f)):(a=null,T=f),null!==a&&(a=function(a,b,c){return b+c}(e,a[0],a[1])),null===a&&(T=e),a}function I(){var a;return/^[0-9]/.test(b.charAt(T))?(a=b.charAt(T),T++):(a=null,0===U&&d("[0-9]")),a}function J(){var a;return/^[1-9]/.test(b.charAt(T))?(a=b.charAt(T),T++):(a=null,0===U&&d("[1-9]")),a}function K(){var a;return/^[0-9a-fA-F]/.test(b.charAt(T))?(a=b.charAt(T),T++):(a=null,0===U&&d("[0-9a-fA-F]")),a}function L(){var a,b;for(U++,a=[],b=O();null!==b;)a.push(b),b=O();return U--,0===U&&null===a&&d("linespace"),a}function M(){var a,b,c,e;for(U++,a=[],e=T,b=L(),null!==b?(c=P(),null!==c?b=[b,c]:(b=null,T=e)):(b=null,T=e);null!==b;)a.push(b),e=T,b=L(),null!==b?(c=P(),null!==c?b=[b,c]:(b=null,T=e)):(b=null,T=e);return U--,0===U&&null===a&&d("whitespace"),a}function N(){var a;return/^[ \t\n\r\f]/.test(b.charAt(T))?(a=b.charAt(T),T++):(a=null,0===U&&d("[ \\t\\n\\r\\f]")),a}function O(){var a;return/^[ \t]/.test(b.charAt(T))?(a=b.charAt(T),T++):(a=null,0===U&&d("[ \\t]")),a}function P(){var a;return/^[\n\r\f]/.test(b.charAt(T))?(a=b.charAt(T),T++):(a=null,0===U&&d("[\\n\\r\\f]")),a}function Q(a){a.sort();for(var b=null,c=[],d=0;d<a.length;d++)a[d]!==b&&(c.push(a[d]),b=a[d]);return c}function R(){for(var a=1,c=1,d=!1,e=0;e<Math.max(T,V);e++){var f=b.charAt(e);"\n"===f?(d||a++,c=1,d=!1):"\r"===f||"\u2028"===f||"\u2029"===f?(a++,c=1,d=!0):(c++,d=!1)}return{line:a,column:c}}var S={start:e,config:f,config_pairs:g,config_pair:h,strings:i,string_def:j,fret_markers:k,fret_marker:l,fret_config:m,fret_config_pairs:n,fret_config_pair:o,value:p,h:q,unicode:r,escape:s,string1:t,string2:u,string:v,identifier:w,nmstart:x,nmchar:y,chars:z,"char":A,integer:B,number:C,"int":D,frac:E,exp:F,digits:G,e:H,digit:I,digit19:J,hexDigit:K,_:L,__:M,whitespace:N,sp:O,nl:P};if(void 0!==c){if(void 0===S[c])throw new Error("Invalid rule name: "+a(c)+".")}else c="start";var T=0,U=0,V=0,W=[],X=S[c]();if(null===X||T!==b.length){var Y=Math.max(T,V),Z=Y<b.length?b.charAt(Y):null,$=R();throw new this.SyntaxError(Q(W),Z,Y,$.line,$.column)}return X},toSource:function(){return this._source}};return b.SyntaxError=function(b,c,d,e,f){function g(b,c){var d,e;switch(b.length){case 0:d="end of input";break;case 1:d=b[0];break;default:d=b.slice(0,b.length-1).join(", ")+" or "+b[b.length-1]}return e=c?a(c):"end of input","Expected "+d+" but "+e+" found."}this.name="SyntaxError",this.expected=b,this.found=c,this.message=g(b,c),this.offset=d,this.line=e,this.column=f},b.SyntaxError.prototype=Error.prototype,b}();